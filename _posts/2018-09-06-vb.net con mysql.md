---
layout: post
title: "vb.net con mysql"
comments: true

description: "暂作记录"
keywords: "dummy content"
author: arkoud
---

>模块内代码

```vb.net
Imports MySql.Data.MySqlClient

Public Class Form1

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            con()
            Dim cmd As String = "SELECT DISTINCT 产品名称 fROM mb_cn"
            Dim da As MySqlDataAdapter = New MySqlDataAdapter(cmd, coon)
            Dim dt As New DataTable
            da.Fill(dt)

            ComboBox1.Items.Add("========")
            Dim i As Integer = 0
            While i < dt.Rows.Count
                ComboBox1.Items.Add(dt.Rows(i)(0).ToString())
                i = i + 1
            End While
            ComboBox1.SelectedIndex = 0
            coon.Close()
            dt.Dispose()
            da.Dispose()

        Catch ex As Exception
            MsgBox("000")
        End Try
    End Sub
End Class
```
>窗体内代码
```vb.net
Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            con()
            Dim cmd As String = "SELECT DISTINCT 产品名称 fROM mb_cn"
            Dim da As MySqlDataAdapter = New MySqlDataAdapter(cmd, coon)
            Dim dt As New DataTable
            da.Fill(dt)

            ComboBox1.Items.Add("========")
            Dim i As Integer = 0
            While i < dt.Rows.Count
                ComboBox1.Items.Add(dt.Rows(i)(0).ToString())
                i = i + 1
            End While
            ComboBox1.SelectedIndex = 0
            coon.Close()
            dt.Dispose()
            da.Dispose()

        Catch ex As Exception
            MsgBox("000")
        End Try
    End Sub
```
